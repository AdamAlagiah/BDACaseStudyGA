Google Analytics Visualizations
==========================================

 **Jesus Martin** - *INSEAD MBA 15J*
 
 jesus.martin.calvo@gmail.com
 
 This case addresses some of the most fundamental issues in Data Analysis and Visualization, 
 getting data from a source: clean, summarize and visualize. Moreover, we will use one of the
 most growing sources of data for any company, user behavior on websites. 
 
 In this report we will show how to create visualizations with data from Google Analytics
 to understand user behavior in a website. If you were able to download the data from your
 Google Analytics account, you will have some insights about how users interact with your
 website. If you are using the example data provided. you will see how users have interacted
 with the website www.encortosabemejor.com. 
 
First, let's take a look at the first 1000 rows of data

```{r, echo=FALSE, message=FALSE, prompt=FALSE, results='asis'}
t1 <- gvisTable(gadata[1:1000,],options=list(showRowNumber=TRUE,width=800, height=min(400,27*(nrow(gadata)+1)),allowHTML=TRUE,page='disable'))
print(t1,'chart')
```

It is very important that you understand each of the columns, let's review its content 

* **year**: the year the data was collected
* **month**: the month of the year the data was collected
* **pagePath**: the URL of the page which the data belongs to, excluding the domain. 
* **sourceMedium**: an identifier for the origin of the user that viewed the page. For
example, (direct) / (none) means tipically that a user typed directly the URL in the browser
while facebook.com / referral means that user came from another website (a referral) and that
website was facebook.com
* **userType**: whether the user had been before in the website or not (New Visitor/Returning Visitor)
* **deviceCategory**: the device of the user
* **entrances**: how many times a user entered the website through that page
* **pageviews**: how many times a user opened that page
* **exits**: how many times that page was the last one opened by a user in the same session
* **timeOnPage**: how many seconds this page has been viewed
* **uniquePageviews**: how many times this page has been viewed in an unique session

From these columns we can have some derived metrics, for example:

* **Average time on page**= timeOnPage/(pageviews-exits)
* **Bounce rate**= exits/entrances
* **Exit rate**= exits/pageviews

For example, we can see the visits per month, measured by the number of entrances

```{r, echo=FALSE, message=FALSE, prompt=FALSE, results='asis'}
entrpmonth <-  group_by(gadata, month) %>% summarise(entrances=sum(entrances))

ggplot(entrpmonth,aes(x=month,y=entrances)) + geom_line() +
  scale_x_discrete(breaks=seq(1:12)) +
  coord_fixed(ratio=1/60)
```

And its evolution year by year
```{r, echo=FALSE, message=FALSE, prompt=FALSE, results='asis'}
entrpmonthyear <-  group_by(gadata, month,year) %>% summarise(entrances=sum(entrances))
ggplot(entrpmonthyear,aes(x=month,y=entrances,group=year,color=factor(year))) + geom_line() + 
scale_x_discrete(breaks=seq(1:12)) +
  coord_fixed(ratio=1/60)
```

Or as a continuous line

```{r, echo=FALSE, message=FALSE, prompt=FALSE, results='asis'}

entryearmonth <-  gadata %>% group_by(yearmonth) %>% summarise(entrances=sum(entrances))
ggplot(entryearmonth,aes(x=factor(yearmonth),y=entrances,group=1)) + geom_line() +
  scale_x_discrete(breaks=entryearmonth$yearmonth) +
  coord_fixed(ratio=1/60) +
  xlab("Year Month")
```
